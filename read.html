<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–°–≤–µ—Ç –°–ª–æ–≤–∞ ‚Äî –ß—Ç–µ–Ω–∏–µ</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <h1>üìñ –ß—Ç–µ–Ω–∏–µ –ë–∏–±–ª–∏–∏</h1>
  <button id="themeToggle">üåô –¢–µ–º–Ω–∞—è —Ç–µ–º–∞</button>

  <!-- üîç –ü–æ–∏—Å–∫–æ–≤—ã–π –±–ª–æ–∫ -->
  <div class="search-block">
    <input type="text" id="searchInput" placeholder="üîé –í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É">
    <button id="searchBtn">–ò—Å–∫–∞—Ç—å</button>
  </div>
  <div id="searchResults" class="verses-block" style="display: none;"></div>

  <!-- üìã –°–µ–ª–µ–∫—Ç–æ—Ä—ã –∫–Ω–∏–≥–∏ –∏ –≥–ª–∞–≤—ã -->
  <div class="selectors">
    <label for="bookSelect">–ö–Ω–∏–≥–∞:</label>
    <select id="bookSelect"></select>

    <label for="chapterSelect">–ì–ª–∞–≤–∞:</label>
    <select id="chapterSelect"></select>
  </div>

  <!-- üìò –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∏—Ö–æ–≤ -->
  <div id="versesContainer" class="verses-block">
    <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–Ω–∏–≥—É –∏ –≥–ª–∞–≤—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å—Ç–∏—Ö–∏.</p>
  </div>

  <!-- üß† –°–∫—Ä–∏–ø—Ç -->
  <script>
    let bibleData;
    const bookSelect = document.getElementById('bookSelect');
    const chapterSelect = document.getElementById('chapterSelect');
    const versesContainer = document.getElementById('versesContainer');

    // üåô –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      const isDark = document.body.classList.contains('dark');
      themeToggle.textContent = isDark ? '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞' : 'üåô –¢–µ–º–Ω–∞—è —Ç–µ–º–∞';
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    // üåê –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    window.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        document.body.classList.add('dark');
        themeToggle.textContent = '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞';
      }

      fetch('data/bible.json')
        .then(response => response.json())
        .then(data => {
          bibleData = data;
          loadBooks();
        })
        .catch(error => {
          versesContainer.innerHTML = '<p>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ë–∏–±–ª–∏–∏.</p>';
          console.error(error);
        });
    });

    // üìã –ó–∞–≥—Ä—É–∑–∫–∞ –∫–Ω–∏–≥
    function loadBooks() {
      bibleData.Books.forEach((book, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = book.BookName;
        bookSelect.appendChild(option);
      });
      bookSelect.addEventListener('change', loadChapters);
    }

    // üìã –ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–∞–≤
    function loadChapters() {
      chapterSelect.innerHTML = '';
      const book = bibleData.Books[bookSelect.value];
      book.Chapters.forEach((chapter, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = `–ì–ª–∞–≤–∞ ${index + 1}`;
        chapterSelect.appendChild(option);
      });
      chapterSelect.addEventListener('change', showVerses);
    }

    // üìò –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∏—Ö–æ–≤
    function showVerses() {
      versesContainer.innerHTML = '';
      const book = bibleData.Books[bookSelect.value];
      const chapter = book.Chapters[chapterSelect.value];
      chapter.Verses.forEach((verseObj, index) => {
        const p = document.createElement('p');
        p.className = 'verse';
        const verseText = verseObj.Text;
        const verseNumber = verseObj.VerseId || (index + 1);
        p.textContent = `${verseNumber}. ${verseText}`;
        versesContainer.appendChild(p);
      });
    }

    // üîç –ü–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤–∞–º
    document.getElementById('searchBtn').addEventListener('click', () => {
      const query = document.getElementById('searchInput').value.trim().toLowerCase();
      const resultsContainer = document.getElementById('searchResults');
      resultsContainer.innerHTML = '';
      if (!query) return;

      let results = [];

      bibleData.Books.forEach(book => {
        book.Chapters.forEach((chapter, chapterIndex) => {
          chapter.Verses.forEach((verseObj, verseIndex) => {
            const text = verseObj.Text.toLowerCase();
            if (text.includes(query)) {
              const ref = `${book.BookName} ${chapterIndex + 1}:${verseObj.VerseId || verseIndex + 1}`;
              results.push(`<p><strong>${ref}</strong> ‚Äî ${verseObj.Text}</p>`);
            }
          });
        });
      });

      if (results.length) {
        resultsContainer.innerHTML = `<h2>üîé –ù–∞–π–¥–µ–Ω–æ: ${results.length} —Å—Ç–∏—Ö–æ–≤</h2>` + results.join('');
      } else {
        resultsContainer.innerHTML = `<p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –ø–æ –∑–∞–ø—Ä–æ—Å—É: <em>${query}</em></p>`;
      }

      resultsContainer.style.display = 'block';
    });
  </script>
</body>
</html>




